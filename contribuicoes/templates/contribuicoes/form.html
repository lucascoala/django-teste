{% extends 'paginas/modelo.html' %}

{% load static %}

{% load crispy_forms_tags %}

{% block conteudo %}
    <h2> {{ titulo }}</h2>
    <p>Preencha todos os campos obrigatórios.</p>
    <hr>

    <form action="" method="POST">
        {% csrf_token %}
        <div class="row">
            <div class="col-md-6">
                {{ form|crispy }}
            </div>
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        Referência de Classes de Custo (CLC)
                    </div>
                    <div class="card-body">
                        <ul class="list-group">
                            <li class="list-group-item">4100 - Dízimo</li>
                            <li class="list-group-item">4200 - Oferta</li>
                            <li class="list-group-item">4300 - Oferta Missionária</li>
                            <li class="list-group-item">4400 - Repasse Presbitério</li>
                            <li class="list-group-item">4500 - Receita Financeira</li>
                            <li class="list-group-item">4600 - Aluguel/Cessão</li>
                            <li class="list-group-item">4900 - Outras Receitas</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="mt-3">
            <a href="{% url 'listar-contribuicoes' %}" class="btn btn-danger float-left">Cancelar</a>
            <button class="btn btn-success float-right" type="submit">{{ botao }}</button>
        </div>
    </form>
{% endblock %}

{% block scripts %}
<script src="{% static 'js/jquery.mask.min.js' %}"></script>
<script>
    $(document).ready(function () {
        $('#id_valor').mask('000000000000.00', {reverse: true, placeholder: "0,00"});
        $('#id_codigo').mask("0000", {reverse: true});
        $('#id_data').mask('00/00/0000', {placeholder: "__/__/____"});
        
        // Auto-fill description based on CLC selection
        $('#id_clc').change(function() {
            var descriptions = {
                '4100': 'Dízimo',
                '4200': 'Oferta',
                '4300': 'Oferta Missionária',
                '4400': 'Repasse Presbitério',
                '4500': 'Receita Financeira',
                '4600': 'Aluguel/Cessão',
                '4900': 'Outras Receitas'
            };
            var selected = $(this).val();
            if (selected && $('#id_descricao').val() === '') {
                $('#id_descricao').val(descriptions[selected]);
            }
        });
    });
</script>
{% endblock %}